# Question 6


## Q6.1
The sequence appears to converge. $A^ku$ is a stochastic vector for all $k$.

Here's an example using a 4x4 column-stochastic matrix.
```matlab
>> format long

A = rand(4,4); A = A ./ sum(A,1);

u = rand(4,1); u = u / sum(u);

U = zeros(4,101);
U(:,1) = u;

for k = 1:100
    U(:,k+1) = A * U(:,k);
end

norm(U(:,101) - U(:,100)) % show A^(k+1)u and A^(k)u are very close


ans =

     0

>> A

A =

  Column 1

   0.062059042557615
   0.259904188939792
   0.500520601628235
   0.177516166874357

  Column 2

   0.322383086006308
   0.123282350031111
   0.413820499401152
   0.140514064561429

  Column 3

   0.165603672394282
   0.228813240523676
   0.291599553524126
   0.313983533557916

  Column 4

   0.500818578762180
   0.126870844553243
   0.136635763401572
   0.235674813283005

>> u

u =

   0.390521019868390
   0.118116447782593
   0.378242909225986
   0.113119623123031

>> U(:,100)

ans =

   0.246990301890847
   0.192809834504678
   0.331294362598475
   0.228905501006001

>> U(:,101)

ans =

   0.246990301890847
   0.192809834504678
   0.331294362598475
   0.228905501006001

>> sum(U(:,101)) % all entries sum to 1

ans =

   1.000000000000000

>> min(U(:,101)) % all entries are non-negative

ans =

   0.192809834504678
```

## Q6.2
The sequence still appears to converge. $A^ku$ is a stochastic vector for all $k$.

Here's an example using a 4x4 column-stochastic matrix.

```matlab
>> format long

A = rand(4,4); A = A ./ sum(A,1);

v = [1 0 0 0]'

V = zeros(4,101);
V(:,1) = v;

for k = 1:100
    V(:,k+1) = A * V(:,k);
end

norm(V(:,101) - V(:,100)) % show A^(k+1)v and A^(k)v are very close

v =

     1
     0
     0
     0


ans =

     0

>> A

A =

  Column 1

   0.052685034531425
   0.037471366237786
   0.368668503397212
   0.541175095833578

  Column 2

   0.444316076281865
   0.061797383914656
   0.270593796583384
   0.223292743220094

  Column 3

   0.009116925639811
   0.258234257509635
   0.124230835968193
   0.608417980882362

  Column 4

   0.193616484591942
   0.328816778953560
   0.103055188053063
   0.374511548401435

>> v

v =

     1
     0
     0
     0

>> V(:,100)

ans =

   0.184254625933154
   0.206531625509006
   0.190634500329400
   0.418579248228438

>> V(:,101)

ans =

   0.184254625933154
   0.206531625509006
   0.190634500329400
   0.418579248228438

>> sum(V(:,101)) % all entries sum to 1

ans =

   0.999999999999999

>> min(V(:,101)) % all entries are non-negative

ans =

   0.184254625933154

>> 
```

## Q6.3
$A^kv$ and $A^ku$ will converge to the same vector when $k$ is large.
$\lim_{k \to \infty} A^k u = \lim_{k \to \infty} A^k v$

Here's an example using a 4x4 column-stochastic matrix:
```matlab
>> format long

A = rand(4,4); A = A ./ sum(A,1);

u = rand(4,1); u = u / sum(u);
v = [1 0 0 0]'

U = zeros(4,101);
V = zeros(4,101);

U(:,1) = u;
V(:,1) = v;

for k = 1:100
    U(:,k+1) = A * U(:,k);
    V(:,k+1) = A * V(:,k);
end

U(:,101) % show value at which A^(k)u converges
V(:,101) % show value at which A^(k)v converges


ans =

   0.110861653193059
   0.274721461326794
   0.279603304161061
   0.334813581319087


ans =

   0.110861653193059
   0.274721461326794
   0.279603304161061
   0.334813581319087
```
